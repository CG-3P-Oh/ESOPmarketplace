jQuery( document ).ready( function($) {
	$( document ).find( '.dipl_advanced_tooltip' ).each( function() {
		let thisObj         = $( this ),
			wrapObj         = thisObj.find( '.dipl_tooltip_trigger_element_wrap' ),
			triggerType     = wrapObj.data( 'trigger-action' ) || 'mouseenter',
			animationType   = wrapObj.data( 'animation' ) || 'fade',
			durartion       = wrapObj.data( 'durartion' ) || '350',
			interactive     = wrapObj.data( 'interactive' ) || false,
			width           = wrapObj.data( 'tooltip-width' ) || '350',
			triggerEl       = wrapObj.data( 'trigger-element' ) || 'button',
			triggerSelector = wrapObj.data( 'trigger-selector' ) || '',
			placement       = wrapObj.data( 'placement-desktop' ) || 'auto';

		let $orderClass   = thisObj.prop('class').match(/(dipl_advanced_tooltip\_[^\s]*)/)[0],
			tooltipEl     = $( '#' + $orderClass + '_content_wrap' );

		// If no content found return.
		if ( ! tooltipEl.length ) return;

		let selector = '.' + $orderClass + ' .dipl_tooltip_trigger_element';
		if ( 'id' === triggerEl ) {
			selector = '#' + triggerSelector;
		}
		if ( 'class' === triggerEl ) {
			selector = '.' + triggerSelector;
		}

		// Update tooltip placement based on device.
		let $winWidth = $(window).width();
		if ( $winWidth < 981 ) {
			placement = wrapObj.data( 'placement-tablet' ) || placement;
		}
		if ( $winWidth < 768 ) {
			placement = wrapObj.data( 'placement-phone' ) || placement;
		}

		tippy( selector, {
			content: tooltipEl.html(),
			placement: placement,
			trigger: triggerType,
			animation: animationType,
			duration: durartion,
			theme: '.' + $orderClass + '_0',
			delay: [ 100, 100 ],
			arrow: false,
			allowHTML: true,
			interactive: interactive,
			appendTo: () => document.body,
			maxWidth: width,
			popperOptions: {
				modifiers: [
					{
						name: 'flip',
						enabled: ( 'auto' === placement ) ? true : false, // Disable flip to lock placement
						options: { fallbackPlacements: [ 'top', 'bottom', 'left', 'right' ] }
					},
					{
						name: 'zIndex',
						enabled: true,
						phase: 'write',
						fn( { state } ) { state.elements.popper.style.zIndex = '99999'; }
					}
				]
			}
		} );

		if ( 'click' === triggerType && thisObj.find( '.dipl_tooltip_trigger_button' ).length > 0 ) {
			thisObj.on( 'click', '.dipl_tooltip_trigger_button', function(e) {
				e.preventDefault();
			} );
		}
	} );
} ); // Document ready.
