jQuery( document ).ready( function($) {
	if ( $( '.dipl_marquee_text' ).length > 0 ) {
		$( '.dipl_marquee_text' ).each( function(e) {
			diplGenerateMarqueeTextClones( $( this ) );
		} );

		// On resize.
		$( window ).on( 'resize', function() {
			$( '.dipl_marquee_text' ).each( function(e) {
				diplGenerateMarqueeTextClones( $( this ) );
			} );
		} );
	}
} );

// Generate marquee text.
function diplGenerateMarqueeTextClones( thisObj ) {

	var $container    = thisObj.find( '.dipl-marquee-text-wrap' );
	var $marqueeInner = thisObj.find( '.dipl-marquee-text-inner' );
	var $baseItem     = $marqueeInner.find( '.dipl-mt-text:first' );

	// Remove old clones.
	$marqueeInner.find( '.dipl-mt-text.dipl-mt-text-dupl' ).remove();

	var containerWidth = $container.outerWidth();
	var itemWidth      = $baseItem.outerWidth(true); // include margin.
	var cloneCount     = Math.ceil( containerWidth / itemWidth ) * 2; // Multiply by 2 for smooth loop.

	for ( var i = 1; i < cloneCount; i++ ) {
		var $clone = $baseItem.clone().addClass( 'dipl-mt-text-dupl' );
		$marqueeInner.append( $clone );
	}

	// Update inner wrapper width
	var newInnerWidth = itemWidth * cloneCount;
	$marqueeInner.width( newInnerWidth + 20 );
}
