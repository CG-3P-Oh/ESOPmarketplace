jQuery( document ).ready( function($) {
	if ( $( '.dipl_split_image' ).length > 0 ) {
		$( '.dipl_split_image' ).each( function() {
			dipl_init_split_image( $( this ) );
		} );
	}
} ); // over document ready.

// Init split image.
function dipl_init_split_image( thisObj ) {
	const $w = thisObj.find( '.dipl_split_image_wrapper' ),
		cols = parseInt( $w.data('image-columns') ) || 3,
		rows = parseInt( $w.data('image-rows') ) || 3;

	$w.css( {
		'display':'grid',
		'grid-template-columns': `repeat(${cols},1fr)`,
		'grid-template-rows': `repeat(${rows},1fr)`
	} );

	const bgSize = `${cols * 100}% ${rows * 100}%`;

	$w.find( '.dipl_split_image_portion' ).css( {
		'background-size': bgSize,
		'background-repeat': 'no-repeat'
	} ).each( function(index) {
		const x = index % cols,
			y = Math.floor(index / cols),
			posX = cols > 1 ? (x / (cols - 1) * 100) : 50,
			posY = rows > 1 ? (y / (rows - 1) * 100) : 50;

		jQuery(this).css( 'background-position', `${posX}% ${posY}%` );
	} );
}
